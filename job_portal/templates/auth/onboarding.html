{% extends 'common/auth-layout.html' %}
{% load static %}

{% block content %}
<main class="flex h-screen">
  <section class="w-1/2 relative bg-cover bg-center text-white flex items-center justify-center p-10"
    style="background-image: url('{% static "images/onboard.jpg" %}');">
    <div class="absolute inset-0 bg-black opacity-60 z-0"></div>
    <div class="z-10 text-center">
      <h1 class="text-4xl font-bold mb-4">Complete Your Profile</h1>
      <p class="text-lg">Help us understand you better for personalized opportunities.</p>
    </div>
  </section>

  <div class="w-1/2 flex items-center justify-center bg-white">
    <div class="w-full max-w-md p-8">
      <h2 class="text-3xl font-semibold text-indigo-700 mb-6 text-center">Profile Setup</h2>

      <form method="POST" enctype="multipart/form-data" class="space-y-6">
        {% csrf_token %}

        {% if role == "job_seeker" %}
        <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
          <label class="block text-gray-700 font-medium mb-3">Profile Picture</label>
          <div class="flex items-center space-x-4">
            <div class="w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300">
              <img id="profile-preview" src="#" alt="Preview" class="hidden w-full h-full object-cover">
              <span id="profile-placeholder" class="text-gray-500 text-xs text-center">Upload<br>Photo</span>
            </div>
            <div class="flex-1">
              <input type="file" name="profile_picture" id="profile_picture" accept="image/*" 
                     class="hidden" onchange="previewImage(this, 'profile-preview', 'profile-placeholder')"/>
              <label for="profile_picture" class="cursor-pointer bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition inline-block text-sm">
                Choose Photo
              </label>
              <p class="text-xs text-gray-500 mt-1">JPG, PNG recommended (max 5MB)</p>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-gray-700 font-medium mb-2">Skills *</label>
          <input type="text" name="skills" placeholder="e.g. Python, Django, JavaScript, React" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" />
        </div>

        <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
          <label class="block text-gray-700 font-medium mb-3">Resume</label>
          <div class="flex items-center justify-between bg-white border border-dashed border-gray-400 rounded-lg px-4 py-3">
            <input type="file" name="resume" id="resume" accept=".pdf,.doc,.docx" class="hidden"
              onchange="document.getElementById('file-name').innerText = this.files[0]?.name || 'No file chosen';" />
            <label for="resume" class="cursor-pointer text-indigo-600 font-medium hover:underline text-sm">
              Choose File
            </label>
            <span id="file-name" class="text-sm text-gray-500">No file chosen</span>
          </div>
          <p class="text-xs text-gray-500 mt-2">PDF, DOC, DOCX files (max 10MB)</p>
        </div>

        {% elif role == "employer" %}
        <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
          <label class="block text-gray-700 font-medium mb-3">Company Logo</label>
          <div class="flex items-center space-x-4">
            <div class="w-20 h-20 bg-gray-200 rounded-lg flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300">
              <img id="logo-preview" src="#" alt="Logo Preview" class="hidden w-full h-full object-cover">
              <span id="logo-placeholder" class="text-gray-500 text-xs text-center">Upload<br>Logo</span>
            </div>
            <div class="flex-1">
              <input type="file" name="company_logo" id="logo" accept="image/*" 
                     class="hidden" onchange="previewImage(this, 'logo-preview', 'logo-placeholder')"/>
              <label for="logo" class="cursor-pointer bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition inline-block text-sm">
                Choose Logo
              </label>
              <p class="text-xs text-gray-500 mt-1">JPG, PNG recommended (max 5MB)</p>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-gray-700 font-medium mb-2">Company Name *</label>
          <input type="text" name="company_name" placeholder="Enter your company name" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" />
        </div>

        <div>
          <label class="block text-gray-700 font-medium mb-2">Location *</label>
          <input name="company_location" placeholder="e.g. New York, USA" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" />
        </div>

        <div>
          <label class="block text-gray-700 font-medium mb-2">Description *</label>
          <textarea name="company_description" rows="4" placeholder="Describe your company..." required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
        </div>
        {% endif %}

        <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition font-medium">
          Complete Profile Setup
        </button>
      </form>

    </div>
  </div>
</main>

<script>
function previewImage(input, previewId, placeholderId) {
    const preview = document.getElementById(previewId);
    const placeholder = document.getElementById(placeholderId);
    const file = input.files[0];
    
    if (file) {
        // Validate file size (5MB max)
        if (file.size > 5 * 1024 * 1024) {
            alert('File size must be less than 5MB');
            input.value = '';
            return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.classList.remove('hidden');
            placeholder.classList.add('hidden');
        }
        reader.readAsDataURL(file);
    } else {
        preview.classList.add('hidden');
        placeholder.classList.remove('hidden');
    }
}
</script>
{% endblock content %}